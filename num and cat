from sklearn.compose import ColumnTransformer
from sklearn.pipeline import Pipeline
from sklearn.impute import SimpleImputer
from sklearn.preprocessing import OneHotEncoder

num_transformer = SimpleImputer(strategy = 'most_frequent')

cat_transformer = Pipeline(steps = [
    ('impute',SimpleImputer(strategy='constant')),
    ('onehot',OneHotEncoder(handle_unknown='ignore'))
])

preprocessor = ColumnTransformer(
transformers=[('num',num_transformer,num_col),
            ('cat',cat_transformer,obj_col)])

